Nome: Gabriel Amorim Santos



Lista de ExercÃ­cios â€“ Banco de Dados

Base: Empresa, Metais, ExtraÃ§Ã£o e CotaÃ§Ã£o

ðŸ“Œ1 â€“ Consulta simples
Liste todos os metais cadastrados na base de dados, exibindo sÃ­mbolo, nome e temperatura de fusÃ£o.
ðŸ“ƒResposta:
SELECT
    metal.Simbolo,
    metal.Nome,
    metal.TempFusao
FROM
    metal;


ðŸ“Œ2 â€“ Filtro com clÃ¡usula WHERE
Liste todas as extraÃ§Ãµes de prata (Ag) realizadas pela empresa com ID 2.
ðŸ“ƒResposta:
SELECT
    empresa.Nome,
    metal.Simbolo,
    extracao.Id,
    extracao.Data,
    extracao.QuantEmTonelada
FROM
    empresa,
    metal,
    extracao
WHERE
    empresa.Id = 2
AND
    metal.Simbolo = "AG"
AND
    empresa.Id = extracao.FK_Empresa_Id
AND
    metal.Simbolo = extracao.FK_Metal_Simbolo;


ðŸ“Œ3 â€“ JOIN entre duas tabelas
Liste o nome das empresas e o nome dos metais extraÃ­dos por elas.
ðŸ“ƒResposta:
SELECT
    empresa.nome,
    extracao.`FK_Metal_Simbolo`,
    metal.nome
FROM
    metal,
    empresa
INNER JOIN
    extracao ON empresa.`Id` = extracao.`FK_Empresa_Id`
GROUP BY
    empresa.`Id`, extracao.`FK_Metal_Simbolo`, metal.`Nome`;


ðŸ“Œ4 â€“ JOIN com funÃ§Ã£o de agregaÃ§Ã£o
Liste o total de toneladas extraÃ­das por cada empresa, ordenando do maior para o menor.
ðŸ“ƒResposta:
SELECT
    empresa.`Nome`,
    SUM(extracao.QuantEmTonelada) AS Total
FROM
    extracao
INNER JOIN
    empresa ON empresa.`Id` = extracao.`FK_Empresa_Id`
GROUP BY
    empresa.`Id`
ORDER BY
    Total DESC;


ðŸ“Œ5 â€“ Subquery + Join + Filtro por data
Liste as extraÃ§Ãµes de ouro feitas nos Ãºltimos 5 dias do mÃªs pela empresa "Vale do Rio Doce".
ðŸ“ƒResposta:
SELECT
    *
FROM 
    extracao
INNER JOIN
    empresa ON extracao.fk_empresa_id = empresa.id 
INNER JOIN
    metal ON extracao.fk_metal_simbolo = metal.simbolo 
WHERE
    empresa.nome = "Vale do Rio Doce" 
AND
    metal.simbolo = "Au" 
AND
    extracao.data >= '2018-03-26' 
AND
    extracao.data <= '2018-03-31';

ðŸ“Œ6 â€“ Subquery com DELETE
Exclua todas as extraÃ§Ãµes de prata (Ag) da empresa " Mosaic" realizadas nos Ãºltimos 5 dias do mÃªs do ano de 2021.
ðŸ“ƒResposta:
DELETE FROM 
    extracao
WHERE
    fk_metal_simbolo = 'Ag'
AND
    fk_empresa_id = (SELECT id FROM empresa WHERE nome = 'Mosaic')
AND
    YEAR(data) = 2021
AND
    DAY(data) BETWEEN 26 AND 31;


ðŸ“Œ7 â€“ CÃ¡lculo do valor financeiro da extraÃ§Ã£o
Liste as extraÃ§Ãµes de todos os metais feitas no Ãºltimo mÃªs do ano de 2019, mostrando o nome da empresa, o nome do metal, a quantidade extraÃ­da (em toneladas), o valor por Kg e o valor total estimado da extraÃ§Ã£o.
ðŸ“ƒResposta:SELECT 
    empresa.nome, 
    metal.simbolo, 
    extracao.data, 
    extracao.QuantEmTonelada, 
    cotacao.ValorKg, 
    (extracao.QuantEmTonelada * cotacao.ValorKg) AS valor_total
FROM
    extracao
INNER JOIN 
    empresa ON extracao.fk_empresa_id = empresa.id
INNER JOIN 
    metal ON extracao.fk_metal_simbolo = metal.simbolo
INNER JOIN 
    cotacao ON extracao.fk_metal_simbolo = cotacao.fk_metal_simbolo
WHERE 
    extracao.data BETWEEN '2019-12-01' AND '2019-12-31';


ðŸ“Œ8 â€“ JOIN com mÃºltiplos filtros
Liste todas as extraÃ§Ãµes feitas pela empresa "Vale do Rio Doce" que extraÃ­ram metais com ponto de fusÃ£o acima de 1000Â°C.
ðŸ“ƒResposta:
SELECT
    empresa.`Nome`,
    metal.`TempFusao`,
    metal.`Simbolo`
FROM
    extracao
INNER JOIN
    empresa ON empresa.`Id` = extracao.`FK_Empresa_Id`
INNER JOIN
    metal ON metal.`Simbolo` = extracao.`FK_Metal_Simbolo`
WHERE
    empresa.`Nome` = "Vale do Rio Doce"
AND
    metal.`TempFusao` >= 1000
GROUP BY
    metal.`Simbolo`;


ðŸ“Œ9 â€“ Subquery com agregaÃ§Ã£o
Liste o nome e o sÃ­mbolo do metal que teve o maior valor por Kg registrado em toda a tabela de cotaÃ§Ãµes.
ðŸ“ƒResposta:
SELECT
    metal.Nome,
    metal.Simbolo,
    cotacao.ValorKg
FROM
    cotacao
INNER JOIN
    metal ON metal.Simbolo = cotacao.FK_Metal_Simbolo
WHERE
    cotacao.ValorKg = (
        SELECT MAX(ValorKg)
        FROM cotacao
    );


ðŸ“Œ10 â€“ AtualizaÃ§Ã£o condicional
Atualize o campo ValorDeMercado da empresa "Vale do Rio Doce" somando 10% ao valor atual, apenas se ela tiver extraÃ­do ouro no mÃªs atual.
ðŸ“ƒResposta:
UPDATE empresa
SET ValorDeMercado = ValorDeMercado * 1.1
WHERE nome = "Vale do Rio Doce"
AND EXISTS(
    SELECT 1 FROM extracao
    WHERE fk_empresa_id = empresa.id
    AND fk_metal_simbolo = "Au"
    AND MONTH(data) = MONTH(CURRENT_DATE())
    AND YEAR(data) = YEAR(CURRENT_DATE())
);


ðŸ“Œ11 â€“ Subquery correlacionada
Liste os nomes das empresas que extraÃ­ram mais de 500 toneladas de qualquer metal em um Ãºnico dia.
ðŸ“ƒResposta:
SELECT t.nome, t.data, t.total_toneladas
FROM (
    SELECT empresa.nome, extracao.data, SUM(extracao.QuantEmTonelada) AS total_toneladas
    FROM empresa
    INNER JOIN extracao ON empresa.id = extracao.fk_empresa_id
    GROUP BY empresa.nome, extracao.data
) AS t
WHERE t.total_toneladas > 500;