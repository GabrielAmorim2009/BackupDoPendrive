SELECT * FROM cotacao ORDER BY `ValorKg` DESC;
SELECT * FROM metal;
SELECT * FROM empresa;
SELECT * FROM extracao;

--ðŸ“Œ1 â€“ JOIN com mÃºltiplos filtros 
--Liste todas as extraÃ§Ãµes feitas pela empresa "Vale do Rio Doce" que extraÃ­ram metais com ponto de fusÃ£o acima de 1000Â°C.
SELECT
    empresa.`Nome`,
    metal.`Nome`,
    metal.`TempFusao`,
    extracao.`Data`
FROM
    extracao
    INNER JOIN empresa ON empresa.`Id` = extracao.`FK_Empresa_Id`
    INNER JOIN metal ON metal.`Simbolo` = extracao.`FK_Metal_Simbolo`
WHERE
    metal.`TempFusao` > 1000
AND
    empresa.`Id` = 2;

--ðŸ“Œ2 â€“ Subquery com agregaÃ§Ã£o 
--Liste o nome e o sÃ­mbolo do metal que teve o maior valor por Kg registrado em toda a tabela de cotaÃ§Ãµes.
SELECT
    metal.`Nome`,
    metal.`Simbolo`,
    cotacao.`ValorKg`
FROM
    metal
INNER JOIN
    cotacao ON cotacao.`FK_Metal_Simbolo` = metal.`Simbolo`
WHERE
    cotacao.`ValorKg` = (SELECT MAX(cotacao.`ValorKg`) AS MaiorValorKG FROM cotacao);

--ðŸ“Œ3 â€“ AtualizaÃ§Ã£o condicional 
--Atualize o campo ValorDeMercado da empresa "Vale do Rio Doce" somando 10% ao valor atual, apenas se ela tiver extraÃ­do ouro no mÃªs atual.
SELECT
    empresa.`Nome`,
    empresa.`ValorDeMercado`,
    extracao.`Data`
FROM
    extracao
INNER JOIN
    empresa ON empresa.`Id` = extracao.`FK_Empresa_Id`
WHERE
    empresa.`Nome` = "Vale do Rio Doce"
AND
    extracao.`FK_Metal_Simbolo` = "AU"
AND
    MONTH(extracao.`Data`) = 8;

UPDATE 
    empresa
INNER JOIN
    extracao ON empresa.`Id` = extracao.`FK_Empresa_Id`
SET 
    empresa.`ValorDeMercado` = empresa.`ValorDeMercado` + (empresa.`ValorDeMercado` * 0.1) 
WHERE
    empresa.`Nome` = "Vale do Rio Doce"
AND
    extracao.`FK_Metal_Simbolo` = "AU"
AND
    MONTH(extracao.`Data`) = 8;

--ðŸ“Œ4 â€“ Subquery correlacionada 
--Liste os nomes das empresas que extraÃ­ram mais de 500 toneladas de qualquer metal em um Ãºnico dia.


--ðŸ“Œ5 â€“ Subquery simples 
--Liste os nomes das empresas que extraÃ­ram ouro (AU) em qualquer data.
SELECT
    empresa.`Nome`,
    extracao.`FK_Metal_Simbolo`
FROM
    empresa
INNER JOIN
    extracao ON extracao.`FK_Empresa_Id` = empresa.`Id`
WHERE
    extracao.`FK_Metal_Simbolo` = "AU"
GROUP BY
    empresa.`Nome`;
--ðŸ“Œ6 â€“ AgregaÃ§Ã£o com GROUP BY 
--Liste o total de toneladas extraÃ­das por cada empresa. 
SELECT
    empresa.`Nome`,
    extracao.`QuantEmTonelada`
FROM
    empresa
INNER JOIN
    extracao ON extracao.`FK_Empresa_Id` = empresa.`Id`
WHERE 
    extracao.`QuantEmTonelada` = (SELECT SUM(extracao`QuantEmTonelada`) FROM extracao)
GROUP BY
    empresa.`Nome`;

--ðŸ“Œ7 â€“ Subquery com filtro por empresa 
--Liste os metais extraÃ­dos pela empresa "Barrick".
SELECT
    empresa.`Nome`,
    metal.`Nome`
FROM
    empresa,
    metal
WHERE
    empresa.`Nome` = "Barrick";